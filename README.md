# pendulum-data

function [ dx, y ] = pendulum( t,x,u,g,I,l_cm,b,m,sigma,varargin)

y = x(1);

dx = [x(2);                                                             ...
      -(b/I)*x(2) - (sigma/I)*sign(x(2)) - (m*g*l_cm/I)*sign(x(1));     ...
     ];

end


clear all;
close all;
clc

load('exp_data.mat');
z = iddata(y_exp,[],.015148008,'Name','Pendulum');
z.OutputName = 'Pendulum Position';
z.OutputUnit = 'rad';
z.TimeUnit = 's';

figure('Name',[z.Name ': output data']);
plot(z);

% Initial Parameter Estimate
g     = 9.81;
I     = 2.4873e-4  % 3.22235e-4;
l_cm  = 2.0800e-2  % 2.96242e-2;
b     = 2.5000e-4  % 1.45852e-4;
m     = 1.1400e-1  % 1.18465e-1;
sigma = 0.0000e00  % 3.01011e-4;

FileName = 'pendulum';
Order = [1 0 2];
Parameters = [g; I; l_cm; b; m; sigma];
InitialStates = [y_exp(1); 0];
Ts = 0;

nlgr = idnlgrey(FileName, Order, Parameters, InitialStates, Ts);
nlgr.OutputName = 'Pendulum Position';
nlgr.OutputUnit = 'rad';
nlgr.TimeUnit = 's';
nlgr = setinit(nlgr, 'Name', {'Pendulum Position' ' Pendulum Velocity'});
nlgr = setinit(nlgr, 'Unit', {'rad' 'rad/s'});
nlgr = setpar(nlgr, 'Name', {'Gravity Constant' 'Moment of Inertia' 'Radius' 'Viscus Damping' 'Mass' Coluomb Friction});
nlgr = setpar(nlgr, 'Unit', {'m/s^2' 'kg-m^2' 'm' 'Nms/rad' 'kg' 'Nm'});
nlgr = setpar(nlgr, 'Minimum', {eps(0) eps(0) eps(0) eps(0) eps(0) 0});
nlgr = setpar(nlgr, 'Fixed', {true false false false false false});
nlgr.SimulationOptions.Solver = 'ode45';
opt = nlgreyestOptions('Display','on');
opt.SearchOption.Advanced.To1X = 1e-8;
opt.SearchOption.Advanced.MaxIter = 50;

nlgr = nlgreyest(z,nlgr,opt)
compare(z,nlgr,1,compareOptions('InitialCondition','model))

nlgr.Parameters(1).Value
nlgr.Parameters(2).Value
nlgr.Parameters(3).Value
nlgr.Parameters(4).Value
nlgr.Parameters(5).Value
nlgr.Parameters(6).Value

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   t:
0
0.015148008
0.030296015
0.045444023
0.06059203
0.075740038
0.090888046
0.106036053
0.121184061
0.136332068
0.151480076
0.166628083
0.181776091
0.196924099
0.212072106
0.227220114
0.242368121
0.257516129
0.272664137
0.287812144
0.302960152
0.318108159
0.333256167
0.348404175
0.363552182
0.37870019
0.393848197
0.408996205
0.424144213
0.43929222
0.454440228
0.469588235
0.484736243
0.49988425
0.515032258
0.530180266
0.545328273
0.560476281
0.575624288
0.590772296
0.605920304
0.621068311
0.636216319
0.651364326
0.666512334
0.681660342
0.696808349
0.711956357
0.727104364
0.742252372
0.75740038
0.772548387
0.787696395
0.802844402
0.81799241
0.833140417
0.848288425
0.863436433
0.87858444
0.893732448
0.908880455
0.924028463
0.939176471
0.954324478
0.969472486
0.984620493
0.999768501
1.014916509
1.030064516
1.045212524
1.060360531
1.075508539
1.090656546
1.105804554
1.120952562
1.136100569
1.151248577
1.166396584
1.181544592
1.1966926
1.211840607
1.226988615
1.242136622
1.25728463
1.272432638
1.287580645
1.302728653
1.31787666
1.333024668
1.348172676
1.363320683
1.378468691
1.393616698
1.408764706
1.423912713
1.439060721
1.454208729
1.469356736
1.484504744
1.499652751
1.514800759
1.529948767
1.545096774
1.560244782
1.575392789
1.590540797
1.605688805
1.620836812
1.63598482
1.651132827
1.666280835
1.681428843
1.69657685
1.711724858
1.726872865
1.742020873
1.75716888
1.772316888
1.787464896
1.802612903
1.817760911
1.832908918
1.848056926
1.863204934
1.878352941
1.893500949
1.908648956
1.923796964
1.938944972
1.954092979
1.969240987
1.984388994
1.999537002
2.014685009
2.029833017
2.044981025
2.060129032
2.07527704
2.090425047
2.105573055
2.120721063
2.13586907
2.151017078
2.166165085
2.181313093
2.196461101
2.211609108
2.226757116
2.241905123
2.257053131
2.272201139
2.287349146
2.302497154
2.317645161
2.332793169
2.347941176
2.363089184
2.378237192
2.393385199
2.408533207
2.423681214
2.438829222
2.45397723
2.469125237
2.484273245
2.499421252
2.51456926
2.529717268
2.544865275
2.560013283
2.57516129
2.590309298
2.605457306
2.620605313
2.635753321
2.650901328
2.666049336
2.681197343
2.696345351
2.711493359
2.726641366
2.741789374
2.756937381
2.772085389
2.787233397
2.802381404
2.817529412
2.832677419
2.847825427
2.862973435
2.878121442
2.89326945
2.908417457
2.923565465
2.938713472
2.95386148
2.969009488
2.984157495
2.999305503
3.01445351
3.029601518
3.044749526
3.059897533
3.075045541
3.090193548
3.105341556
3.120489564
3.135637571
3.150785579
3.165933586
3.181081594
3.196229602
3.211377609
3.226525617
3.241673624
3.256821632
3.271969639
3.287117647
3.302265655
3.317413662
3.33256167
3.347709677
3.362857685
3.378005693
3.3931537
3.408301708
3.423449715
3.438597723
3.453745731
3.468893738
3.484041746
3.499189753
3.514337761
3.529485769
3.544633776
3.559781784
3.574929791
3.590077799
3.605225806
3.620373814
3.635521822
3.650669829
3.665817837
3.680965844
3.696113852
3.71126186
3.726409867
3.741557875
3.756705882
3.77185389
3.787001898
3.802149905
3.817297913
3.83244592
3.847593928
3.862741935
3.877889943
3.893037951
3.908185958
3.923333966
3.938481973
3.953629981
3.968777989
3.983925996
3.999074004
4.014222011
4.029370019
4.044518027
4.059666034
4.074814042
4.089962049
4.105110057
4.120258065
4.135406072
4.15055408
4.165702087
4.180850095
4.195998102
4.21114611
4.226294118
4.241442125
4.256590133
4.27173814
4.286886148
4.302034156
4.317182163
4.332330171
4.347478178
4.362626186
4.377774194
4.392922201
4.408070209
4.423218216
4.438366224
4.453514231
4.468662239
4.483810247
4.498958254
4.514106262
4.529254269
4.544402277
4.559550285
4.574698292
4.5898463
4.604994307
4.620142315
4.635290323
4.65043833
4.665586338
4.680734345
4.695882353
4.711030361
4.726178368
4.741326376
4.756474383
4.771622391
4.786770398
4.801918406
4.817066414
4.832214421
4.847362429
4.862510436
4.877658444
4.892806452
4.907954459
4.923102467
4.938250474
4.953398482
4.96854649
4.983694497
4.998842505
5.013990512
5.02913852
5.044286528
5.059434535
5.074582543
5.08973055
5.104878558
5.120026565
5.135174573
5.150322581
5.165470588
5.180618596
5.195766603
5.210914611
5.226062619
5.241210626
5.256358634
5.271506641
5.286654649
5.301802657
5.316950664
5.332098672
5.347246679
5.362394687
5.377542694
5.392690702
5.40783871
5.422986717
5.438134725
5.453282732
5.46843074
5.483578748
5.498726755
5.513874763
5.52902277
5.544170778
5.559318786
5.574466793
5.589614801
5.604762808
5.619910816
5.635058824
5.650206831
5.665354839
5.680502846
5.695650854
5.710798861
5.725946869
5.741094877
5.756242884
5.771390892
5.786538899
5.801686907
5.816834915
5.831982922
5.84713093
5.862278937
5.877426945
5.892574953
5.90772296
5.922870968
5.938018975
5.953166983
5.968314991
5.983462998
5.998611006
6.013759013
6.028907021
6.044055028
6.059203036
6.074351044
6.089499051
6.104647059
6.119795066
6.134943074
6.150091082
6.165239089
6.180387097
6.195535104
6.210683112
6.22583112
6.240979127
6.256127135
6.271275142
6.28642315
6.301571157
6.316719165
6.331867173
6.34701518
6.362163188
6.377311195
6.392459203
6.407607211
6.422755218
6.437903226
6.453051233
6.468199241
6.483347249
6.498495256
6.513643264
6.528791271
6.543939279
6.559087287
6.574235294
6.589383302
6.604531309
6.619679317
6.634827324
6.649975332
6.66512334
6.680271347
6.695419355
6.710567362
6.72571537
6.740863378
6.756011385
6.771159393
6.7863074
6.801455408
6.816603416
6.831751423
6.846899431
6.862047438
6.877195446
6.892343454
6.907491461
6.922639469
6.937787476
6.952935484
6.968083491
6.983231499
6.998379507
7.013527514
7.028675522
7.043823529
7.058971537
7.074119545
7.089267552
7.10441556
7.119563567
7.134711575
7.149859583
7.16500759
7.180155598
7.195303605
7.210451613
7.22559962
7.240747628
7.255895636
7.271043643
7.286191651
7.301339658
7.316487666
7.331635674
7.346783681
7.361931689
7.377079696
7.392227704
7.407375712
7.422523719
7.437671727
7.452819734
7.467967742
7.48311575
7.498263757
7.513411765
7.528559772
7.54370778
7.558855787
7.574003795
7.589151803
7.60429981
7.619447818
7.634595825
7.649743833
7.664891841
7.680039848
7.695187856
7.710335863
7.725483871
7.740631879
7.755779886
7.770927894
7.786075901
7.801223909
7.816371917
7.831519924
7.846667932
7.861815939
7.876963947
7.892111954
7.907259962
7.92240797
7.937555977
7.952703985
7.967851992
7.983


y:
-0.987356229
-0.962856229
-0.920656229
-0.860056229
-0.777256229
-0.682156229
-0.575556229
-0.459656229
-0.331556229
-0.196656229
-0.050856229
0.082529078
0.227529078
0.354829078
0.470629078
0.584229078
0.677729078
0.760629078
0.821929078
0.867229078
0.893329078
0.900229078
0.889429078
0.860329078
0.812029078
0.746029078
0.668529078
0.569629078
0.463029078
0.350229078
0.227529078
0.096429078
-0.027856229
-0.159056229
-0.280256229
-0.389156229
-0.495756229
-0.581656229
-0.662156229
-0.723556229
-0.766456229
-0.794056229
-0.805556229
-0.799456229
-0.779556229
-0.739656229
-0.685956229
-0.616956229
-0.535656229
-0.441256229
-0.341556229
-0.233456229
-0.117656229
-0.003356229
0.112529078
0.223729078
0.330329078
0.433129078
0.517429078
0.591129078
0.648629078
0.693829078
0.723029078
0.736829078
0.739129078
0.717629078
0.683929078
0.638629078
0.575729078
0.497529078
0.417029078
0.322629078
0.216029078
0.111729078
0.008929078
-0.101556229
-0.204256229
-0.294056229
-0.387556229
-0.464256229
-0.528756229
-0.584756229
-0.626156229
-0.649156229
-0.659156229
-0.656856229
-0.638356229
-0.606956229
-0.563256229
-0.505756229
-0.436656229
-0.359256229
-0.274856229
-0.182856229
-0.082356229
0.012029078
0.103329078
0.199129078
0.282029078
0.362529078
0.430829078
0.492129078
0.538929078
0.573429078
0.594929078
0.602629078
0.598729078
0.578829078
0.546629078
0.499029078
0.440729078
0.379429078
0.301129078
0.221429078
0.140129078
0.050329078
-0.040956229
-0.124556229
-0.207356229
-0.280956229
-0.352356229
-0.409056229
-0.460456229
-0.496556229
-0.524856229
-0.537156229
-0.537156229
-0.526456229
-0.503456229
-0.467356229
-0.419856229
-0.366856229
-0.300956229
-0.234956229
-0.158256229
-0.083056229
-0.004056229
0.075629078
0.149329078
0.222129078
0.288129078
0.344129078
0.393229078
0.436129078
0.465329078
0.480629078
0.486029078
0.482929078
0.466829078
0.440029078
0.397829078
0.354829078
0.297329078
0.233629078
0.168429078
0.098729078
0.026629078
-0.045556229
-0.111456229
-0.175956229
-0.237256229
-0.294056229
-0.338556229
-0.379156229
-0.405956229
-0.425156229
-0.434356229
-0.429756229
-0.417556229
-0.394456229
-0.363856229
-0.321656229
-0.274056229
-0.223456229
-0.162056229
-0.100756229
-0.040156229
0.025029078
0.087129078
0.150829078
0.203029078
0.252029078
0.296529078
0.331829078
0.361029078
0.380129078
0.387829078
0.389329078
0.381729078
0.358729078
0.331829078
0.298129078
0.252029078
0.207629078
0.154629078
0.098729078
0.040429078
-0.019456229
-0.073856229
-0.126856229
-0.175956229
-0.226556229
-0.260256229
-0.295556229
-0.320856229
-0.337756229
-0.346956229
-0.346956229
-0.338556229
-0.320856229
-0.296356229
-0.265656229
-0.228856229
-0.185156229
-0.140656229
-0.089956229
-0.043956229
0.007429078
0.062629078
0.110929078
0.153929078
0.196129078
0.231329078
0.260529078
0.282029078
0.299629078
0.308029078
0.306529078
0.301129078
0.286629078
0.265929078
0.236729078
0.203729078
0.166129078
0.124029078
0.078729078
0.033529078
-0.014056229
-0.057756229
-0.098456229
-0.142156229
-0.178256229
-0.208856229
-0.232656229
-0.251856229
-0.267156229
-0.271056229
-0.272556229
-0.265656229
-0.250256229
-0.231856229
-0.207356229
-0.176656229
-0.142956229
-0.103856229
-0.067756229
-0.024856229
0.013529078
0.053429078
0.091729078
0.126329078
0.159229078
0.184629078
0.208329078
0.224429078
0.235229078
0.237529078
0.234429078
0.229029078
0.212929078
0.195329078
0.170029078
0.142429078
0.113229078
0.074129078
0.039629078
0.007429078
-0.030156229
-0.063956229
-0.097656229
-0.124556229
-0.152156229
-0.172856229
-0.189756229
-0.202756229
-0.207356229
-0.208856229
-0.206556229
-0.196656229
-0.181256229
-0.164356229
-0.140656229
-0.118356229
-0.089956229
-0.058556229
-0.025556229
0.004329078
0.032729078
0.064129078
0.093329078
0.116329078
0.138529078
0.154629078
0.166129078
0.177729078
0.180729078
0.179229078
0.174629078
0.164629078
0.152329078
0.131629078
0.113229078
0.087929078
0.064129078
0.037329078
0.007429078
-0.020256229
-0.044756229
-0.070856229
-0.092256229
-0.113056229
-0.127556229
-0.141356229
-0.149856229
-0.155956229
-0.158256229
-0.154456229
-0.148256229
-0.139856229
-0.126056229
-0.109956229
-0.090756229
-0.069256229
-0.048556229
-0.022556229
-0.002556229
0.020429078
0.043429078
0.066429078
0.081029078
0.101029078
0.112529078
0.124029078
0.132429078
0.134729078
0.130929078
0.127029078
0.120929078
0.110229078
0.097129078
0.081829078
0.064129078
0.045029078
0.024329078
0.002829078
-0.013256229
-0.032456229
-0.050856229
-0.067756229
-0.083056229
-0.092256229
-0.101556229
-0.106156229
-0.108456229
-0.110756229
-0.107656229
-0.103056229
-0.095356229
-0.082356229
-0.070856229
-0.057756229
-0.042456229
-0.025556229
-0.010956229
0.005829078
0.021229078
0.036529078
0.049629078
0.064129078
0.071829078
0.084129078
0.090229078
0.091729078
0.091729078
0.089429078
0.087129078
0.079529078
0.072629078
0.060329078
0.049629078
0.035029078
0.021229078
0.008929078
-0.006356229
-0.017156229
-0.030156229
-0.041656229
-0.049356229
-0.060056229
-0.063956229
-0.069256229
-0.069256229
-0.073156229
-0.070856229
-0.065456229
-0.060056229
-0.051656229
-0.046256229
-0.036356229
-0.025556229
-0.017956229
-0.003356229
0.006629078
0.015029078
0.023529078
0.035829078
0.044229078
0.051929078
0.055729078
0.058829078
0.058029078
0.059529078
0.055729078
0.052629078
0.048029078
0.040429078
0.031229078
0.022729078
0.015829078
0.004329078
-0.000256229
-0.010956229
-0.015556229
-0.024056229
-0.029456229
-0.033256229
-0.035556229
-0.036356229
-0.037056229
-0.037056229
-0.035556229
-0.032456229
-0.028656229
-0.025556229
-0.020956229
-0.015556229
-0.007956229
-0.003356229
0.001229078
0.007429078
0.015029078
0.018129078
0.024329078
0.025029078
0.029629078
0.028129078
0.027329078
0.031929078
0.028929078
0.024329078
0.022729078
0.019729078
0.015029078
0.013529078
0.008129078
0.006629078
0.001229078
-0.001056229
-0.006356229
-0.009456229
-0.010956229
-0.014056229
-0.013256229
-0.013256229
-0.014056229
-0.014056229
-0.014056229
-0.012556229
-0.007156229
-0.007156229
-0.003356229
-0.001756229
0.002829078
0.004329078
0.006629078
0.007429078
0.009729078
0.009729078
0.008929078
0.007429078
0.008129078
0.008929078
0.008129078
0.004329078
0.005829078
0.002829078
0.001229078
-0.001056229
-0.001756229
-0.001756229
-0.001056229
-0.001756229
-0.003356229
-0.003356229
-0.001756229
-0.001756229
-0.000256229
-0.000256229
0.002829078
0.001229078
0.003529078
0.005829078
0.004329078
0.004329078
0.004329078
0.004329078
0.002029078
0.005129078
0.002829078
0.004329078
0.001229078
0.002829078
0.003529078
0.004329078
0.002029078
0.002829078
0.002029078
0.001229078


